# Configuration for packet-checkins

# This section defines the configuration for each BBS.
bbses:
  W1XSC:
    transport: kpc3plus
    ax25: W1XSC-1
  W2XSC:
    transport: kpc3plus
    ax25: W2XSC-1
  W3XSC:
    transport: kpc3plus
    ax25: W3XSC-1
  W4XSC:
    transport: kpc3plus
    ax25: W4XSC-1

# This section defines the default parameters that apply to all practice
# sessions, unless overridden in the definitions of the specific sessions below.
sessionDefaults:
  # The BBS(es) to which check-in messages should be sent.  This is W2XSC on
  # most days, but W4XSC when the session end date falls in the second week of
  # the month.  Note that this setting allows multiple destination BBSes; all
  # matching rules apply, and messages sent to any of them would be considered
  # valid.
  #
  # Delivery receipts and problem responses for a particular check-in message
  # are sent from the BBS that received that message.  Session reports are
  # sent from the first BBS matched by this setting.
  toBBSes:
    - { when: 'DAY=8-14', then: W4XSC }
    - { when: 'DAY=1-7,15-31', then: W2XSC }
  # The BBS(es) that are considered "down" during a session.  These are W1XSC
  # when the session end date is in the first week of the month, W2XSC in the
  # second week, etc.  Note that this setting allows the possibility of having
  # multiple BBSes "down"; all matching rules apply.
  downBBSes:
    - { when: 'DAY=1-7', then: W1XSC }
    - { when: 'DAY=8-14', then: W2XSC }
    - { when: 'DAY=15-21', then: W3XSC }
    - { when: 'DAY=22-28', then: W4XSC }
  # Message type(s) that are accepted for check-in messages for the session.
  # This is ICS-213 in February, June, and October; EOC-213RR in March, July,
  # and November; and OA Municipal Status in April, August, and December.
  # Plain text messages are accepted in any month, and are the only messages
  # accepted in January, April, and September.
  messageTypes:
    - { when: 'MONTH=2,6,10', then: ICS213 }
    - { when: 'MONTH=3,7,11', then: EOC213RR }
    - { when: 'MONTH=4,8,12', then: MuniStat }
    - { when: 'MONTH=4,8,12', then: JurisStat }
    - { when: 'MONTH=1-12', then: 'plain' }
  # Session reports are sent to the packet email list (as well as to the
  # individuals who checked in).
  reportTo:
    - packet@scc-ares-races.groups.io

# This section defines which practice sessions exist, and their parameters.  Any
# parameters not specified here are taken from sessionDefaults, above.
sessions:
  # Settings for the Monday night SPECS net sessions.
  PKTMON:
    name: SPECS Net
    prefix: MON
    # Each PKTMON session starts at midnight after the end of the previous
    # PKTMON session, and ends the following Monday night at 20:00.
    start: HOUR=0 MINUTE=0
    end: WEEKDAY=Monday HOUR=20 MINUTE=0
  # Settings for the Tuesday night SVECS net sessions.
  PKTTUE:
    name: SVECS Net
    prefix: TUE
    # Each PKTTUE session starts at midnight after the end of the previous
    # PKTTUE session, and ends the following Tuesday night at 20:00.
    start: HOUR=0 MINUTE=0
    end: WEEKDAY=Tuesday HOUR=20 MINUTE=0
  # Settings for the test sessions.
  PKTEST:
    name: Test Check-Ins
    prefix: TST
    # Each PKTEST session starts at 20:00 daily and runs until 20:00 the
    # following day.
    start: HOUR=20 MINUTE=0
    end: HOUR=20 MINUTE=0
    # We retrieve PKTEST messages every hour of every day.
    # PKTEST session reports are sent only to those who checked in.
    reportTo: []
    # PKTEST sessions are not included in the weekly summaries.
    excludeFromWeek: true

# This section defines the minimum acceptable form versions.
minimumVersions:
  PackItForms: 3.2
  AHFacStat: 2.2
  ICS213: 2.1
  EOC213RR: 2.3
  JurisStat: 2.2
  MuniStat: 2.1
  RACES-MAR: 2.1
  SheltStat: 2.1

# This section defines how each detected problem is treated.  Each problem has
# the following attributes:
#   - label (required): this is a short string label for the problem.  It
#         appears in session reports and in the subject line of problem
#         responses.
#   - actions (required): this defines the actions to be taken when the problem
#         is detected.  It contains zero or more of the following keywords:
#         report    - the problem gets listed in the report
#         error     - the message gets counted as an error
#         dontcount - the message does not get counted as a valid checkin
#         dropmsg   - drop the entire message from the report
#   - response (optional): this defines the text describing the problem that
#         should be included in the problem response.  (A problem response is
#         sent only if the message has one or more problems with defined
#         response text).  The response text may include interpolated variables.
#   - responses (optional): some problems can choose between multiple response
#         texts based on the specifics of the problem detected.  In those cases,
#         there will be multiple response texts under the "responses" key rather
#         than a single response text under the "response" key.
problems:
  BounceMessage:
    label: message has no return address (probably auto-response)
    actions: report dontcount
  CallSignConflict:
    label: call sign conflict
    actions: report error
    response: |
      This message has conflicting call signs.  The Subject line says the call
      sign is {FROMCALLSIGN}, but the Operator Call Sign field of the form says
      {OPCALL}.  The two should agree.  (This message will be counted as a
      practice attempt by {FROMCALLSIGN}.)
  DeliveryReceipt:
    label: DELIVERED receipt message
    actions: dropmsg
  FormCorrupt:
    label: incorrectly encoded form
    actions: report error
    response: |
      This message appears to contain an encoded form, but the encoding is
      incorrect.  It appears to have been created or edited by software other
      than the current PackItForms software.  Please use current PackItForms
      software to encode messages containing forms.
  FormDestination:
    label: incorrect destination for form
    actions: report error
    responses:
      both: |
        This message form is addressed to ICS Position "{ACTUALPOSN}" at
        Location "{ACTUALLOC}".  {MSGTYPE}s should be addressed to {EXPECTPOSNS}
        at {EXPECTLOCS}.
      loc: |
        This message form is addressed to Location "{ACTUALLOC}".  {MSGTYPE}s
        should be addressed to Location {EXPECTLOCS}.
      pos: |
        This message form is addressed to ICS Position "{ACTUALPOSN}".
        {MSGTYPE}s should be addressed to ICS Position {EXPECTPOSNS}.
  FormHandlingOrder:
    label: incorrect handling order for form
    actions: report error
    response: |
      This message has handling order {ACTUALHO}.  According to the SCCo
      ARES/RACES Recommended Form Routing document, it should have handling
      order {EXPECTHO}.
  FormInvalid:
    label: invalid form contents
    actions: report error
    response: |
      This message contains a form with invalid contents:
      {PROBLEMS}
      Please verify the correctness of the form before sending.
  FormSubject:
    label: message subject doesn't agree with form contents
    actions: report error
    response: |
      This message has
          Subject: {ACTUALSUBJ}
      but, based on the contents of the form, it should have
          Subject: {EXPECTSUBJ}
      PackItForms automatically generates the Subject line from the form
      contents; it should not be overridden manually.
  FormVersion:
    label: form version out of date
    actions: report error
    response: |
      This message contains version {ACTUALVER} of the {MSGTYPE}, but that
      version is not current.  Please use version {EXPECTVER} or newer of the
      form.  (You can get the newer form by updating your PackItForms
      installation.)
  FromBBSDown:
    label: message from incorrect BBS (simulated outage)
    actions: report error
    response: |
      This message was sent from {FROMBBS}, which has a simulated outage for
      {SESSIONNAME} on {SESSIONDATE}.  Practice messages should not be sent from
      BBSes that have a simulated outage.
  HandlingOrderCode:
    label: unknown handling order code
    actions: report error
    response: |
      The Subject line of this message contains an invalid Handling Order code
      ({HANDLING}). The valid codes are "I" for Immediate, "P" for Priority, and
      "R" for Routine.
  MessageCorrupt:
    label: message could not be parsed
    actions: report dontcount
  MessageNotASCII:
    label: message has non-ASCII characters
    actions: report error
    response: |
      This message contains characters that are not in the standard ASCII
      character set (i.e., not on a standard keyboard).  Non-standard characters
      should be avoided in packet messages, because the receiving system may not
      know how to render them.  Note that some software may introduce undesired
      non-standard characters (e.g., Microsoft Word's "smart quotes" feature).
      If you use message text composed in such software, make sure those
      features are disabled.
  MessageNotPlainText:
    label: not a plain text message
    actions: report error
    responses:
      normal: |
        This message is not a plain text message.  All SCCo packet messages
        should be plain text only.  ("Rich text" or HTML-formatted messages,
        common in email systems, are far larger than plain text messages and put
        too much strain on the packet infrastructure.)  Please configure your
        software to send plain text messages when sending to an SCCo BBS.
      winlink: |
        This message is not a plain text message.  All SCCo packet messages
        should be plain text only.  Note: messages from winlink.org are not
        plain text messages; they use an encoding system ("quoted-printable")
        that Outpost cannot decode.
  MessageTooEarly:
    label: message before start of practice session
    actions: report dontcount
    response: |
      This message arrived at {TOBBS} on {MSGDATE}.  However, practice messages
      for {SESSIONNAME} aren't accepted until {SESSIONSTART}.
  MessageTooLate:
    label: message after end of practice session
    actions: report dontcount
    response: |
      This message arrived at {TOBBS} on {MSGDATE}.  That was too late to be
      counted for the {SESSIONNAME} on {SUBJECTDATE}.
  MessageTypeWrong:
    label: incorrect message type
    actions: report error
    response: |
      This message is {AMSGTYPE}.  For the {SESSIONNAME} on {SESSIONDATE},
      {AEXPECTTYPE} is expected.
  MsgNumFormat:
    label: incorrect message number format
    actions: report error
    response: |
      The message number of this message is not formatted correctly.  It should
      have a format like "XND-042P", containing:
        - a three-character prefix (usually the sender's call sign suffix),
        - a dash,
        - a number with at least three digits, and
        - a "P", "M", or "R" suffix.
      All letters should be upper case.  In Outpost, the format of the message
      number is set in the Message Settings dialog, which should be configured
      according to county standards.
  MsgNumPrefix:
    label: incorrect message number prefix
    actions: report
    response: |
      The message number of this message has the prefix "{ACTUALPFX}".  The
      prefix should be the last three characters of your call sign,
      "{EXPECTPFX}".
  MultipleMessagesFromAddress:
    label: multiple messages from this address
    actions: report
  NoCallSign:
    label: no call sign in message
    actions: report dontcount
    responses:
      form: |
        This message cannot be counted because it's not clear who sent it.
        There is no call sign in the return address, or after the word
        "Practice" on the subject line, or in the Operator Call field of the
        form.  In order for a message to count, there must be a call sign in at
        least one of those places.
      plain: |
        This message cannot be counted because it's not clear who sent it.
        There is no call sign in the return address or after the word "Practice"
        on the subject line.  In order for a message to count, there must be a
        call sign in at least one of those places.
  PIFOVersion:
    label: PackItForms version out of date
    actions: report error
    response: |
      This message used version {ACTUALVER} of PackItForms to encode the form,
      but that version is not current.  Please use PackItForms version
      {EXPECTVER} or newer to encode messages containing forms.
  PracticeSubjectFormat:
    label: incorrect practice message details
    actions: report
    responses:
      form: |
        The {SUBJECTFIELD} field of this form does not have the correct format.
        It should have the word "Practice" followed by four comma-separated
        fields:
            Practice CallSign, FirstName, Jurisdiction, NetDate
        NetDate should be in the form MM/DD/YYYY.
      plain: |
        The Subject of this message does not have the correct format.  After the
        message number and handling order, it should have the word
        "Practice" followed by four comma-separated fields:
            Practice CallSign, FirstName, Jurisdiction, NetDate
        NetDate should be in the form MM/DD/YYYY.
  ReadReceipt:
    label: unexpected READ receipt message
    actions: report dontcount
    response: |
      This message is an Outpost "read receipt", which should not have been
      sent.  Most likely, your Outpost installation has the "Auto-Read Receipt"
      setting turned on.  The SCCo-standard Outpost configuration specifies that
      this setting should be turned off.  You can find it on the Receipts tab of
      the Message Settings dialog in Outpost.
  SessionDate:
    label: incorrect net date in subject
    actions: report
    response: |
      This message is being counted for {SESSIONNAME} on {SESSIONDATE}, but the
      subject line says it's intended for a net on {SUBJECTDATE}.  This may
      indicate that the message was sent to the wrong net.
  SubjectFormat:
    label: incorrect subject line format
    actions: report error
    responses:
      parse: |
        This message has an incorrect subject line format.  According to SCCo
        standards, the subject should look like
            AAA-111P_R_Practice A6AAA, Charlie, Nowhereville, 03/16/2019
            (msgnum) |            |    (name)   (city)        (net date)
              (handling order)  (call sign)
      plainform: |
        This message has an incorrect subject line format.  According to SCCo
        standards, the subject should look like
            AAA-111P_R_Practice A6AAA, Charlie, Nowhereville, 03/16/2019
            (msgnum) |            |    (name)   (city)        (net date)
              (handling order)  (call sign)
        Note that there is no form name between the handling order and the word
        "Practice" for plain text messages.  If this is in fact a form message,
        it is improperly encoded and was not recognized as a form.
      practice: |
        This message has an incorrect subject line format.  According to SCCo
        standards, the subject should look like
            AAA-111P_R_Practice A6AAA, Charlie, Nowhereville, 03/16/2019
            (msgnum) |            |    (name)   (city)        (net date)
              (handling order)  (call sign)
        Note that there is no underline after the word "Practice".
  SubjectHasSeverity:
    label: severity on subject line
    actions: report error
    response: |
      The Subject line of this message contains a both a Severity code and a
      Handling Order code ("_{SEVERITY}/{HANDLING}_").  This is an outdated
      Subject line style.  Current SCCo standards include only the Handling
      Order code on the Subject line ("_{HANDLING}_").
  ToBBS:
    label: message to incorrect BBS
    actions: report dontcount
    response: |
      This message was sent to {TOCALLSIGN} at {TOBBS}.  Practice messages for
      {SESSIONNAME} on {SESSIONDATE} must be sent to {TOCALLSIGN} at
      {SESSIONBBSES}.
  ToBBSDown:
    label: message to incorrect BBS (simulated outage)
    actions: report dontcount
    response: |
      This message was sent to {TOCALLSIGN} at {TOBBS}, but {TOBBS} has a
      simulated outage for {SESSIONNAME} on {SESSIONDATE}.  Practice messages
      for this session must be sent to {TOCALLSIGN} at {SESSIONBBSES}.
  UnknownJurisdiction:
    label: unknown jurisdiction
    actions: report
    response: |
      The jurisdiction "{JURISDICTION}" is not recognized.  Please use one of
      the recognized jurisdiction names or abbreviations.

# This section lists the known jurisdiction names and their abbreviations.
jurisdictions:
  Alameda County: XAL
  American Red Cross: ARC
  CalFIRE Santa Clara Unit: SCU
  CalOES Coastal Region: COS
  Campbell: CBL
  Contra Costa County: XCC
  Cupertino: CUP
  Gilroy: GIL
  Hospitals: HOS
  Loma Prieta: LMP
  Los Altos: LOS
  Los Altos Hills: LAH
  Los Gatos: LGT
  Marin County: XMR
  Milpitas: MLP
  Monte Sereno: MSO
  Monterey County: XMY
  Morgan Hill: MRG
  Mountain View: MTV
  NASA/AMES: NAM
  Palo Alto: PAF
  San Benito County: XBE
  San Francisco County: XSF
  San Jose: SJC
  San Jose Water Co: SJW
  San Mateo County: XSM
  Santa Clara: SNC
  Santa Clara County: XSC
  Santa Clara Valley Water District: VWD
  Santa Cruz County: XCZ
  Saratoga: SAR
  Stanford University: STU
  Sunnyvale: SNY

# This section defines the expected handling order and destination of each of
# the different form types.  For HandlingOrder, possible values are "computed"
# (for ICS213 and EOC213RR only), "IMMEDIATE", "PRIORITY", or "ROUTINE".  For
# ToICSPosition and ToLocation, any listed value is considered acceptable.
# Fields that are omitted from this section are not checked.
formRouting:
  ICS213:
    HandlingOrder: computed # based on severity in form
  AHFacStat:
    HandlingOrder: ROUTINE
    ToICSPosition:
      - EMS Unit
      - Public Health Unit
      - Medical Health Branch
      - Operations Section
    ToLocation:
      - MHJOC
      - County EOC
  EOC213RR:
    HandlingOrder: computed # based on priority in form
    ToICSPosition:
      - Planning Section
    ToLocation:
      - County EOC
  JurisStat:
    HandlingOrder: IMMEDIATE
    ToICSPosition:
      - Situation Analysis Unit
      - Planning Section
    ToLocation:
      - County EOC
  MuniStat:
    HandlingOrder: IMMEDIATE
    ToICSPosition:
      - Situation Analysis Unit
      - Planning Section
    ToLocation:
      - County EOC
  RACES-MAR:
    HandlingOrder: ROUTINE
    ToICSPosition:
      - RACES Chief Radio Officer
      - RACES Unit
      - Operations Section
    ToLocation:
      - County EOC
  SheltStat:
    HandlingOrder: PRIORITY
    ToICSPosition:
      - Mass Care and Shelter Unit
      - Care and Shelter Branch
      - Operations Section

listenAddr: none
